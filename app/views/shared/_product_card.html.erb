<div class="product-card">
    <div class="product-header">
      <div></div>
      <div class="list-and-title-and-price">
        <h6><%= product.list.name %></h6>
        <%= link_to product_path(product) do %>
          <h5><%= product.title  %></h5>
          <h6 class="price">$<%= product.price.to_i %></h6>
        <% end %>
      </div>
      <i class="fa-sharp fa-regular fa-ellipsis" data-bs-toggle="modal" data-bs-target="#editOrDeleteModal-<%= product.id %>"></i>
    </div>
    <% if product.photos.attached? %>
      <div class="product-card-image">
        <%= image_tag product.photos.first %>
      </div>
    <% else %>
        <p>No image available</p>
    <% end %>
  <div class="cardbar">
    <div class="cardbar-left">
      <%= link_to user_path(product.user) do %>
        <%= image_tag product.user.avatar, class: 'avatar-small' %>
      <% end %>
      <%= link_to user_path(product.user) do %>
        <div class="username">
          <%= product.user.username %>
        </div>
      <% end %>
    </div>
    <% if product.logo.attached? %>
        <%= image_tag product.logo, class: "cardbar-logo" %>
    <% else %>
      <p>No image available</p>
    <% end %>
    <div class="cardbar-right">
      <div class="cardbar-iconbox">
        <i class="fa-sharp fa-light fa-bookmark"></i>
        <p>30</p>
      </div>
      <div class="cardbar-iconbox">
        <i class="fa-light fa-circle-plus"></i>
        <p>8</p>
      </div>
      <div class="cardbar-iconbox">
        <i class="fa-light fa-comment"></i>
        <p>72</p>
      </div>
    </div>
  </div>
  <div class="product-card-review">
    <%= link_to product_path(product) do %>
      <p class="truncate-3-lines">
        <%= product.review%>
      </p>
    <% end %>
  </div>
</div>

<!--Edit or delete modal, bootstrap -->

<!-- Edit or delete modal -->
<div class="modal fade" id="editOrDeleteModal-<%= product.id %>" tabindex="-1" aria-labelledby="editOrDeleteModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-body custom-modal">
        <button type="button" class="btn-close custom-modal-close-button" data-bs-dismiss="modal" aria-label="Close"></button>
        <h5><%= product.title %></h5>
        <div class="btn btn-danger w-100" data-bs-target="#deleteModal-<%= product.id %>" data-bs-toggle="modal" data-bs-dismiss="modal" %>Delete</div>
        <%= link_to 'Edit', edit_product_path(product), class: "btn btn-primary w-100" %>
      </div>
    </div>
  </div>
</div>

<!-- Delete modal -->
<div class="modal fade" id="deleteModal-<%= product.id %>" aria-hidden="true" aria-labelledby="deleteModal" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-body custom-modal">
        <button type="button" class="btn-close custom-modal-close-button" data-bs-dismiss="modal" aria-label="Close"></button>
        <i class="fa-sharp fa-light fa-trash-can custom-modal-icon"></i>
        <h5>Are you sure you want to delete this listing?</h5>
        <p>All related data including comments will be permanently deleted.</p>
        <%= link_to 'Yes, please delete', product_path(product),  data: {turbo_method: :delete}, class: "btn btn-danger w-100" %>

        <button type="button w-100" class="btn btn-secondary w-100" data-bs-dismiss="modal">No, I want to keep this listing.</button>
      </div>
    </div>
  </div>
</div>
