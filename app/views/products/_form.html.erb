<div class="new-product-container" data-controller="imageuploader">
  <h3>Share a favorite product</h3>
  <%= simple_form_for @product, url: products_path, method: :post do |f| %>

    <div class="title-and-price-input">
      <%= f.input :title, required: true, data: { target: "amazon-prefill-product-form.title" } %>
      <%= f.input :price, required: true, data: { target: "amazon-prefill-product-form.price" } %>
    </div>
    <%= f.association :list, collection: List.where(user: current_user), prompt: 'Select a list', required: true %>



    <%= f.input :description, required: true, input_html: { id: 'long-text-area', class: 'long-text-area' },  data: { target: "amazon-prefill-product-form.description" } %>


    <%= f.input :review, required: true, input_html: { id: 'long-text-area', class: 'long-text-area' } %>


    <%= f.input :url, required: true, data: { target: "amazon-prefill-product-form.url" } %>


    <div>
      <%= f.label :logo, class: "label mb-2" %>
      <div id="dropzone" class="dropzone dropzone-default dz-clickable mb-3" data-controller="dropzone" data-dropzone-max-file-size="2" data-dropzone-max-files="1" data-dropzone-logo="<%= { url: url_for(@logo), blob_signed_id: @logo.is_a?(ActiveStorage::Blob) ? @logo.signed_id : @logo.blob.signed_id }.to_json unless @logo.nil? %>">
      <%= f.file_field :logo, direct_upload: true, data: { target: 'dropzone.input' } %>
      <div class="dropzone-msg dz-message needsclick text-gray-600">
        <h3 class="dropzone-msg-title">Drag or click here to upload</h3>
        <span class="dropzone-msg-desc text-sm">Allowed file types png jpg</span>
        </div>
      </div>
    </div>

    <div>
      <%= f.label :photos, class: "label mb-2" %>
      <div id="dropzone" class="dropzone dropzone-default dz-clickable mb-3" data-controller="dropzone" data-dropzone-max-file-size="2" data-dropzone-max-files="20" data-dropzone-photos="<%= @photos.map { |photo| { url: url_for(photo), blob_signed_id: photo.is_a?(ActiveStorage::Attachment) ? photo.blob.signed_id : photo.signed_id } }.to_json unless @photos.nil? %>">
      <%= f.file_field :photos, multiple: true, direct_upload: true, data: { target: 'dropzone.input' } %>
      <div class="dropzone-msg dz-message needsclick text-gray-600">
        <h3 class="dropzone-msg-title">Drag or click here to upload</h3>
        <span class="dropzone-msg-desc text-sm">Allowed file types png jpg</span>
        </div>
      </div>
    </div>

    <%= f.button :submit, class: "w-100 button button-primary" %>
  <% end %>
</div>
